<div class="accordion" id="accordion-{{ section }}">
    {% for metric_group, metrics in metric_data[section].items() %}
      {% if metric_group != "description" %}
        <div class="accordion-item">
          <h2 class="accordion-header" id="heading-{{ section }}-{{ loop.index }}">
            <button class="accordion-button collapsed" type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#collapse-{{ section }}-{{ loop.index }}"
                    aria-expanded="false"
                    aria-controls="collapse-{{ section }}-{{ loop.index }}">
              {{ metric_group }}
            </button>
          </h2>
          <div id="collapse-{{ section }}-{{ loop.index }}"
               class="accordion-collapse collapse"
               aria-labelledby="heading-{{ section }}-{{ loop.index }}"
               data-bs-parent="#accordion-{{ section }}">
            <div class="accordion-body">
              <p><em>{{ metrics["description"] }}</em></p>
  
              {% for metric_type, value in metrics["metrics"].items() %}
                {% if value is string or value is number %}
                  <p><strong>{{ metric_type }}</strong>: {{ value }}</p>
  
                {% elif value is mapping %}
                  {% if "description" in value %}
                    <h6>{{ metric_type }}</h6>
                    <p>{{ value["description"] }}</p>
                  {% else %}
                    <h6>{{ metric_type }}</h6>
                  {% endif %}
  
                  {% for k, v in value.items() %}
                    {% if k != "description" %}
                      {% if v is mapping %}
                        {% for k1, v1 in v.items() %}
                          <p><strong>{{ k1 }}</strong>: {{ v1 }}</p>
                        {% endfor %}
                      {% elif v is sequence and v is not string %}
                        {% if v and v[0] is mapping %}
                          <table class="table table-sm table-bordered">
                            <thead>
                              <tr>
                                {% for col in v[0].keys() %}
                                  <th>{{ col }}</th>
                                {% endfor %}
                              </tr>
                            </thead>
                            <tbody>
                              {% for row in v %}
                                <tr>
                                  {% for col in v[0].keys() %}
                                    <td>{{ row[col] }}</td>
                                  {% endfor %}
                                </tr>
                              {% endfor %}
                            </tbody>
                          </table>
                        {% else %}
                          <ul>
                            {% for item in v %}
                              <li>{{ item }}</li>
                            {% endfor %}
                          </ul>
                        {% endif %}
                      {% else %}
                        <p><strong>{{ k }}</strong>: {{ v }}</p>
                      {% endif %}
                    {% endif %}
                  {% endfor %}
  
                {% elif value is sequence and value is not string %}
                  {% if value and value[0] is mapping %}
                    <table class="table table-sm table-bordered">
                      <thead>
                        <tr>
                          {% for col in value[0].keys() %}
                            <th>{{ col }}</th>
                          {% endfor %}
                        </tr>
                      </thead>
                      <tbody>
                        {% for row in value %}
                          <tr>
                            {% for col in value[0].keys() %}
                              <td>{{ row[col] }}</td>
                            {% endfor %}
                          </tr>
                        {% endfor %}
                      </tbody>
                    </table>
                  {% else %}
                    <ul>
                      {% for item in value %}
                        <li>{{ item }}</li>
                      {% endfor %}
                    </ul>
                  {% endif %}
                {% endif %}
              {% endfor %}
            </div>
          </div>
        </div>
      {% endif %}
    {% endfor %}
  </div>
  